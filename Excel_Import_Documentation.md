# üìä –ò–º–ø–æ—Ä—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ Excel

## API Endpoint
```
POST /api/User/import-excel
```

## –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–∞
- **file** (IFormFile, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): Excel —Ñ–∞–π–ª (.xlsx –∏–ª–∏ .xls)
- **organizationId** (Guid, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–π): ID –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

## –§–æ—Ä–º–∞—Ç Excel —Ñ–∞–π–ª–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–±–ª–∏—Ü—ã (–Ω–∞—á–∏–Ω–∞—è —Å–æ 2-–π —Å—Ç—Ä–æ–∫–∏):

| A: –§–ò–û | B: Email | C: –¢–µ–ª–µ—Ñ–æ–Ω | D: –¢–µ–ª–µ—Ñ–æ–Ω —Ä–æ–¥–∏—Ç–µ–ª—è | E: –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è | F: –†–æ–ª—å | G: –õ–æ–≥–∏–Ω |
|--------|----------|------------|---------------------|------------------|---------|----------|
| –ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á | ivan@mail.ru | 87001234567 | 87009876543 | 23.07.2005 | Student | |
| –ü–µ—Ç—Ä–æ–≤–∞ –ú–∞—Ä–∏—è | maria@mail.ru | +77002345678 | | 15.03.1985 | Teacher | maria_p |

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏:
- **A: –§–ò–û** - –ø–æ–ª–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **C: –¢–µ–ª–µ—Ñ–æ–Ω** - —Ç–µ–ª–µ—Ñ–æ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∞–≤—Ç–æ—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ 8XXXXXXXXXX)
- **E: –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è** - —Ñ–æ—Ä–º–∞—Ç: DD.MM.YYYY –∏–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Excel Date
- **F: –†–æ–ª—å** - Student, Teacher, Administrator, Owner

### –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏:
- **B: Email** - —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞
- **D: –¢–µ–ª–µ—Ñ–æ–Ω —Ä–æ–¥–∏—Ç–µ–ª—è** - –¥–ª—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤
- **G: –õ–æ–≥–∏–Ω** - –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –§–ò–û

## –õ–æ–≥–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ª–æ–≥–∏–Ω–∞
–ï—Å–ª–∏ –ª–æ–≥–∏–Ω –Ω–µ —É–∫–∞–∑–∞–Ω –≤ –∫–æ–ª–æ–Ω–∫–µ G, –æ–Ω –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –¢—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∞—Ü–∏—è –∫–∏—Ä–∏–ª–ª–∏—Ü—ã –≤ –ª–∞—Ç–∏–Ω–∏—Ü—É
- –§–æ—Ä–º–∞—Ç: `—Ñ–∞–º–∏–ª–∏—è_–ø–µ—Ä–≤–∞—è_–±—É–∫–≤–∞_–∏–º–µ–Ω–∏`
- –ü—Ä–∏–º–µ—Ä: "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω" ‚Üí `ivanov_i`

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –ª–æ–≥–∏–Ω–æ–≤
–ü—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –ª–æ–≥–∏–Ω–∞ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Å—É—Ñ—Ñ–∏–∫—Å:
- `ivanov_i` ‚Üí `ivanov_i_2` ‚Üí `ivanov_i_3`

### 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–∞—Ä–æ–ª—è
–ü–∞—Ä–æ–ª—å –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ **–î–î–ú–ú–ì–ì**:
- –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è: 23.07.2005
- –ü–∞—Ä–æ–ª—å: `230705`

### 4. –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞
–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ —Ñ–æ—Ä–º–∞—Ç—É 8XXXXXXXXXX:
- `+77001234567` ‚Üí `87001234567`
- `7001234567` ‚Üí `87001234567`
- `87001234567` ‚Üí `87001234567` (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)

## –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ (FormData)

```javascript
const formData = new FormData();
formData.append('file', fileInput.files[0]);
formData.append('organizationId', '123e4567-e89b-12d3-a456-426614174000');

const response = await fetch('/api/User/import-excel', {
    method: 'POST',
    headers: {
        'Authorization': 'Bearer your-jwt-token'
    },
    body: formData
});

const result = await response.json();
```

## –§–æ—Ä–º–∞—Ç –æ—Ç–≤–µ—Ç–∞

### –£—Å–ø–µ—à–Ω—ã–π –∏–º–ø–æ—Ä—Ç:
```json
{
    "totalRows": 100,
    "successCount": 95,
    "errorCount": 5,
    "createdUsers": [
        {
            "rowNumber": 2,
            "userId": "guid-here",
            "fullName": "–ò–≤–∞–Ω–æ–≤ –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤–∏—á",
            "login": "ivanov_i",
            "generatedPassword": "230705",
            "email": "ivan@mail.ru",
            "phone": "87001234567",
            "role": "Student"
        }
    ],
    "errors": [
        {
            "rowNumber": 15,
            "fullName": "–°–∏–¥–æ—Ä–æ–≤ –ü–µ—Ç—Ä",
            "email": "invalid-email",
            "phone": "12345",
            "errors": [
                "–ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç email",
                "–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞"
            ]
        }
    ]
}
```

## –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- –¢–æ–ª—å–∫–æ **Administrator** –º–æ–∂–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## –í–∞–ª–∏–¥–∞—Ü–∏—è

### –ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è:
- ‚úÖ –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–ª–µ–π (–§–ò–û, –¢–µ–ª–µ—Ñ–æ–Ω, –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è, –†–æ–ª—å)
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å —Ä–æ–ª–∏ (Student, Teacher, Administrator, Owner)
- ‚úÖ –§–æ—Ä–º–∞—Ç –¥–∞—Ç—ã —Ä–æ–∂–¥–µ–Ω–∏—è
- ‚úÖ –¢–∏–ø —Ñ–∞–π–ª–∞ (.xlsx, .xls)

### –í —Å–ª—É—á–∞–µ –æ—à–∏–±–æ–∫:
- –£—Å–ø–µ—à–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É—é—Ç—Å—è
- –°—Ç—Ä–æ–∫–∏ —Å –æ—à–∏–±–∫–∞–º–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –º–∞—Å—Å–∏–≤–µ `errors`
- –ö–∞–∂–¥–∞—è –æ—à–∏–±–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –∏ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

## –í–∞–∂–Ω–æ! üìå
- **–ü–∞—Ä–æ–ª–∏** –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç–µ API —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
- –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –ø–∞—Ä–æ–ª–∏ –ø–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞ –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
- Email –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª–µ–Ω - –º–æ–∂–Ω–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ email
- –õ–æ–≥–∏–Ω—ã —É–Ω–∏–∫–∞–ª—å–Ω—ã –≤ —Ä–∞–º–∫–∞—Ö –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

## –ü—Ä–∏–º–µ—Ä Excel —à–∞–±–ª–æ–Ω–∞
–ü–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ - –∑–∞–≥–æ–ª–æ–≤–∫–∏ (–ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–º–ø–æ—Ä—Ç–µ):

```
| –§–ò–û | Email | –¢–µ–ª–µ—Ñ–æ–Ω | –¢–µ–ª–µ—Ñ–æ–Ω —Ä–æ–¥–∏—Ç–µ–ª—è | –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è | –†–æ–ª—å | –õ–æ–≥–∏–Ω |
```

–ù–∞—á–∏–Ω–∞—è —Å–æ –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏ - –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
