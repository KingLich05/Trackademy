<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard API –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .endpoint { margin: 10px 0; padding: 10px; border: 1px solid #ccc; border-radius: 5px; }
        .response { background: #f5f5f5; padding: 10px; margin-top: 10px; white-space: pre-wrap; font-family: monospace; max-height: 300px; overflow-y: auto; }
        button { padding: 8px 15px; margin: 5px; cursor: pointer; }
        .success { background-color: #d4edda; border-color: #c3e6cb; }
        .error { background-color: #f8d7da; border-color: #f5c6cb; }
    </style>
</head>
<body>
    <h1>üöÄ Dashboard API –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h1>
    
    <div class="endpoint">
        <h3>1. –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞—à–±–æ—Ä–¥–∞</h3>
        <button onclick="testEndpoint('/api/Dashboard/overview', 'overview-result')">GET /api/Dashboard/overview</button>
        <div id="overview-result" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>2. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h3>
        <button onclick="testEndpoint('/api/Dashboard/students', 'students-result')">GET /api/Dashboard/students</button>
        <div id="students-result" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>3. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≥—Ä—É–ø–ø</h3>
        <button onclick="testEndpoint('/api/Dashboard/groups', 'groups-result')">GET /api/Dashboard/groups</button>
        <div id="groups-result" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>4. –£—Ä–æ–∫–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</h3>
        <button onclick="testEndpoint('/api/Dashboard/lessons-today', 'lessons-result')">GET /api/Dashboard/lessons-today</button>
        <div id="lessons-result" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>5. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏</h3>
        <button onclick="testEndpoint('/api/Dashboard/attendance', 'attendance-result')">GET /api/Dashboard/attendance</button>
        <div id="attendance-result" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>6. –ì—Ä—É–ø–ø—ã —Å –Ω–∏–∑–∫–æ–π —É—Å–ø–µ–≤–∞–µ–º–æ—Å—Ç—å—é</h3>
        <button onclick="testEndpoint('/api/Dashboard/low-performance-groups', 'low-groups-result')">GET /api/Dashboard/low-performance-groups</button>
        <div id="low-groups-result" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>7. –ù–µ–æ–ø–ª–∞—Ç–∏–≤—à–∏–µ —Å—Ç—É–¥–µ–Ω—Ç—ã</h3>
        <button onclick="testEndpoint('/api/Dashboard/unpaid-students', 'unpaid-result')">GET /api/Dashboard/unpaid-students</button>
        <div id="unpaid-result" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>8. –ü—Ä–æ–±–Ω—ã–µ —Å—Ç—É–¥–µ–Ω—Ç—ã</h3>
        <button onclick="testEndpoint('/api/Dashboard/trial-students', 'trial-result')">GET /api/Dashboard/trial-students</button>
        <div id="trial-result" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>9. –¢–æ–ø –ø—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª–∏</h3>
        <button onclick="testEndpoint('/api/Dashboard/top-teachers?limit=5', 'teachers-result')">GET /api/Dashboard/top-teachers</button>
        <div id="teachers-result" class="response"></div>
    </div>

    <div class="endpoint">
        <h3>10. –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è</h3>
        <button onclick="testEndpoint('/api/Dashboard/latest-schedule-update', 'schedule-result')">GET /api/Dashboard/latest-schedule-update</button>
        <div id="schedule-result" class="response"></div>
    </div>

    <script>
        const BASE_URL = 'https://localhost:7188'; // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π URL –µ—Å–ª–∏ –Ω—É–∂–Ω–æ

        async function testEndpoint(endpoint, resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.innerHTML = 'Loading...';
            resultDiv.className = 'response';

            try {
                const response = await fetch(BASE_URL + endpoint, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });

                const data = await response.json();
                
                if (response.ok) {
                    resultDiv.className = 'response success';
                    resultDiv.innerHTML = `‚úÖ Status: ${response.status}\n\n${JSON.stringify(data, null, 2)}`;
                } else {
                    resultDiv.className = 'response error';
                    resultDiv.innerHTML = `‚ùå Status: ${response.status}\n\n${JSON.stringify(data, null, 2)}`;
                }
            } catch (error) {
                resultDiv.className = 'response error';
                resultDiv.innerHTML = `‚ùå Network Error: ${error.message}`;
            }
        }

        // –¢–µ—Å—Ç –≤—Å–µ—Ö endpoints —Å—Ä–∞–∑—É
        async function testAllEndpoints() {
            const endpoints = [
                { url: '/api/Dashboard/overview', id: 'overview-result' },
                { url: '/api/Dashboard/students', id: 'students-result' },
                { url: '/api/Dashboard/groups', id: 'groups-result' },
                { url: '/api/Dashboard/lessons-today', id: 'lessons-result' },
                { url: '/api/Dashboard/attendance', id: 'attendance-result' },
                { url: '/api/Dashboard/low-performance-groups', id: 'low-groups-result' },
                { url: '/api/Dashboard/unpaid-students', id: 'unpaid-result' },
                { url: '/api/Dashboard/trial-students', id: 'trial-result' },
                { url: '/api/Dashboard/top-teachers?limit=5', id: 'teachers-result' },
                { url: '/api/Dashboard/latest-schedule-update', id: 'schedule-result' }
            ];

            for (const endpoint of endpoints) {
                await testEndpoint(endpoint.url, endpoint.id);
                await new Promise(resolve => setTimeout(resolve, 1000)); // –ü–∞—É–∑–∞ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏
            }
        }
    </script>

    <div style="margin-top: 20px; padding: 20px; background: #e9ecef; border-radius: 5px;">
        <h3>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ</h3>
        <button onclick="testAllEndpoints()" style="background: #007bff; color: white; border: none; padding: 10px 20px;">
            üîÑ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ endpoints
        </button>
    </div>

    <div style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 5px;">
        <h4>üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:</h4>
        <ol>
            <li>–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –∑–∞–ø—É—â–µ–Ω (dotnet run --project Trackademy.Api)</li>
            <li>–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å BASE_URL –≤ –∫–æ–¥–µ</li>
            <li>–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ—Ç–¥–µ–ª—å–Ω—ã—Ö endpoints</li>
            <li>–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ "–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ endpoints" –¥–ª—è –ø–æ–ª–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏</li>
        </ol>
    </div>
</body>
</html>